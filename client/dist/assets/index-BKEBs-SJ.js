import{W as k,b as l,O as n,U as T,az as w,ae as A,a9 as u,aB as z,a3 as R}from"./index-7GMsSKZT.js";const{Title:b}=T,{Search:F}=A,$=y=>{const[x,h]=l.useState([]),[c,I]=l.useState({current:1,pageSize:10,total:0}),[g,S]=l.useState(!1),[_,M]=l.useState(""),d=async(e=1,o=10,r="")=>{var a,t;S(!0);try{const s=await R.get("/sale/getAllSales",{params:{page:e,limit:o,search:r}}),{data:i,total:C,page:N,limit:j}=s.data;h(i),I({current:N,pageSize:j,total:C})}catch(s){y.error(((t=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to fetch sales")}finally{S(!1)}};l.useEffect(()=>{d(c.current,c.pageSize,_)},[]);const p=e=>{d(e.current,e.pageSize,_)},P=e=>{M(e),d(1,c.pageSize,e)},f=[{title:"Customer Name",dataIndex:"C_Name",key:"C_Name"},{title:"Customer ID",dataIndex:"C_ID",key:"C_ID"},{title:"Total Sold Price",dataIndex:"Total_Price",key:"Total_Price",render:e=>`Rs. ${e==null?void 0:e.toFixed(2)}`},{title:"Sale Performed By",dataIndex:"employeeId",key:"employeeId",render:e=>e?`${e.userName} (${e==null?void 0:e.role})`:"N/A"},{title:"Sale Date",dataIndex:"createdAt",key:"createdAt",render:(e,o)=>z(o.createdAt).format("DD MMM YYYY, hh:mm A")}],D=e=>{const o=[{title:"Medicine Name",dataIndex:["Med_ID","Med_Name"],key:"Med_Name",render:(r,a)=>{var t;return((t=a==null?void 0:a.Med_ID)==null?void 0:t.Med_Name)||"N/A"}},{title:"Quantity Sold",dataIndex:"Sale_Qty",key:"Sale_Qty"},{title:"Price Per Unit",dataIndex:["Med_ID","Med_Price"],key:"Med_Price",render:(r,a)=>{var t,s;return`Rs. ${((s=(t=a==null?void 0:a.Med_ID)==null?void 0:t.Med_Price)==null?void 0:s.toFixed(2))||"0.00"}`}},{title:"Total Price",key:"TotalPrice",render:(r,a)=>{var i;const t=((i=a==null?void 0:a.Med_ID)==null?void 0:i.Med_Price)||0,s=(a==null?void 0:a.Sale_Qty)||0;return`Rs. ${(t*s).toFixed(2)}`}}];return n.jsx("div",{children:n.jsx(u,{columns:o,dataSource:e.medicines,rowKey:(r,a)=>{var t;return r._id||((t=r==null?void 0:r.Med_ID)==null?void 0:t._id)||a},pagination:!1})})};return n.jsxs("div",{style:{padding:"24px"},children:[n.jsx(b,{level:3,children:"Sales"}),n.jsx(w,{style:{marginBottom:16},children:n.jsx(F,{placeholder:"Search by customer name",allowClear:!0,enterButton:!0,onSearch:P})}),n.jsx(u,{columns:f,dataSource:x,rowKey:"_id",expandable:{expandedRowRender:D},pagination:c,loading:g,onChange:p})]})},Q=k($);export{Q as default};
