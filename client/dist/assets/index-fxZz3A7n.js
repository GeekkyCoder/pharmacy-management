import{b as s,M as t,T as M,a7 as j,a8 as N,b0 as k}from"./index-C7YdiJGM.js";import{S as w,F as l}from"./Table-DMXDyJOs.js";import"./index-CVEjP0KC.js";import"./Pagination-Dmp0qYb0.js";const{Title:D}=M,{Search:b}=j,T=()=>{const[m,p]=s.useState([]),[o,y]=s.useState({current:1,pageSize:10,total:0}),[u,i]=s.useState(!1),[c,I]=s.useState(""),r=async(e=1,a=10,d="")=>{i(!0);try{const n=await k.get("http://localhost:8000/invoice/getAllInvoices",{params:{page:e,limit:a,search:d}}),{data:S,total:_,page:v,limit:C}=n.data;p(S),y({current:v,pageSize:C,total:_})}catch(n){console.error("Error fetching invoices:",n)}finally{i(!1)}};s.useEffect(()=>{r(o.current,o.pageSize,c)},[]);const x=e=>{r(e.current,e.pageSize,c)},h=e=>{I(e),r(1,o.pageSize,e)},f=[{title:"Invoice ID",dataIndex:"invoiceId",key:"invoiceId"},{title:"Customer Name",dataIndex:"C_Name",key:"C_Name"},{title:"Customer ID",dataIndex:"C_ID",key:"C_ID"},{title:"No. of Items",dataIndex:"No_Of_Items",key:"No_Of_Items"},{title:"Sale Performed By",dataIndex:["employee"],key:"employee",render:e=>e?`${e.E_Username}`:"N/A"},{title:"Invoice Date",dataIndex:"createdAt",key:"createdAt",render:(e,a)=>N(a.createdAt).format("DD MMM YYYY, hh:mm A")}],g=e=>{const a=[{title:"Medicine Name",dataIndex:"Med_Name",key:"Med_Name"},{title:"Quantity",dataIndex:"Med_Qty",key:"Med_Qty"},{title:"Price",dataIndex:"Med_Price",key:"Med_Price"}];return t.jsx(l,{columns:a,dataSource:e.items,rowKey:(d,n)=>n,pagination:!1})};return t.jsxs("div",{style:{padding:"24px"},children:[t.jsx(D,{level:3,children:"Invoices"}),t.jsx("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:t.jsx(w,{style:{marginBottom:16},children:t.jsx(b,{placeholder:"Search by customer name",allowClear:!0,enterButton:!0,onSearch:h})})}),t.jsx(l,{columns:f,dataSource:m,rowKey:"_id",expandable:{expandedRowRender:g},pagination:o,loading:u,onChange:x})]})};export{T as default};
