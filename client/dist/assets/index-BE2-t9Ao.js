import{b as l,M as s,T as m,a7 as C,a8 as T,b0 as j}from"./index-Dk2PLuz_.js";import{S as k,F as y}from"./Table-C14PA0_g.js";import"./index-By0mG6xB.js";import"./Pagination-Va9bAHz7.js";const{Title:N}=m,{Search:w}=C,E=()=>{const[u,x]=l.useState([]),[c,h]=l.useState({current:1,pageSize:10,total:0}),[p,_]=l.useState(!1),[S,I]=l.useState(""),d=async(t=1,o=10,r="")=>{_(!0);try{const e=await j.get("http://localhost:8000/sale/getAllSales",{params:{page:t,limit:o,search:r}}),{data:a,total:n,page:i,limit:D}=e.data;x(a),h({current:i,pageSize:D,total:n})}catch(e){console.error("Error fetching sales:",e)}finally{_(!1)}};l.useEffect(()=>{d(c.current,c.pageSize,S)},[]);const g=t=>{d(t.current,t.pageSize,S)},M=t=>{I(t),d(1,c.pageSize,t)},f=[{title:"Customer Name",dataIndex:"C_Name",key:"C_Name"},{title:"Customer ID",dataIndex:"C_ID",key:"C_ID"},{title:"Total Price",dataIndex:"Total_Price",key:"Total_Price",render:t=>`Rs. ${t==null?void 0:t.toFixed(2)}`},{title:"Sale Performed By",dataIndex:"employeeId",key:"employeeId",render:t=>t?`${t.E_Username}`:"N/A"},{title:"Sale Date",dataIndex:"createdAt",key:"createdAt",render:(t,o)=>T(o.createdAt).format("DD MMM YYYY, hh:mm A")}],P=t=>{const o=[{title:"Medicine Name",dataIndex:["Med_ID","Med_Name"],key:"Med_Name",render:(r,e)=>{var a;return((a=e==null?void 0:e.Med_ID)==null?void 0:a.Med_Name)||"N/A"}},{title:"Quantity Sold",dataIndex:"Sale_Qty",key:"Sale_Qty"},{title:"Price Per Unit",dataIndex:["Med_ID","Med_Price"],key:"Med_Price",render:(r,e)=>{var a,n;return`Rs. ${((n=(a=e==null?void 0:e.Med_ID)==null?void 0:a.Med_Price)==null?void 0:n.toFixed(2))||"0.00"}`}},{title:"Total Price",key:"TotalPrice",render:(r,e)=>{var i;const a=((i=e==null?void 0:e.Med_ID)==null?void 0:i.Med_Price)||0,n=(e==null?void 0:e.Sale_Qty)||0;return`Rs. ${(a*n).toFixed(2)}`}}];return s.jsx("div",{children:s.jsx(y,{columns:o,dataSource:t.medicines,rowKey:(r,e)=>{var a;return r._id||((a=r==null?void 0:r.Med_ID)==null?void 0:a._id)||e},pagination:!1})})};return s.jsxs("div",{style:{padding:"24px"},children:[s.jsx(N,{level:3,children:"Sales"}),s.jsx(k,{style:{marginBottom:16},children:s.jsx(w,{placeholder:"Search by customer name",allowClear:!0,enterButton:!0,onSearch:M})}),s.jsx(y,{columns:f,dataSource:u,rowKey:"_id",expandable:{expandedRowRender:P},pagination:c,loading:p,onChange:g})]})};export{E as default};
